{
  "version": "2.0.0",
  "inputs": [
    {
      "id": "BuildType",
      "type": "pickString",
      "description": "Select build type",
      "options": ["Debug", "Release"],
      "default": "Release"
    },
    {
      "id": "NetworkInterface",
      "type": "pickString",
      "description": "Select network interface",
      "options": ["lo", "eth0", "enp130s0", "wlp129s0f0"],
      "default": "lo"
    },
    {
        "id": "Config Path",
        "type": "promptString",
        "description": "Input config path",
        "default": ""
    },
  ],
  "tasks": [
    {
      "label": "Download Ort",
      "type": "shell",
      "command": "bash scripts/get_ort.sh && bash scripts/pt_to_onnx_uv.sh",
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Convert pt to onnx",
      "type": "shell",
      "command": "${env:HOME}/.local/bin/uv",
      "args": [
          "run","python", "scripts/pt_to_onnx.py",
          "--pt", "${input:Config Path}/policy.pt",
          "--onnx", "${input:Config Path}/policy.onnx", 
          "--config", "${input:Config Path}/config.yaml"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": []
    },
    {
      "label": "Build",
      "type": "shell",
      "command": "source ${env:WORKSPACE}/install/setup.sh; colcon build --packages-up-to legged_rl_deploy --cmake-args -DCMAKE_BUILD_TYPE=${input:BuildType}",
      "group": "build",
      "options": { "cwd": "${env:WORKSPACE}" },
      "problemMatcher": []
    },

    // Controller
    {
      "label": "ROS2: RL",
      "type": "process",
      "command": "bash",
      "args": [
        "${env:WORKSPACE}/src/unitree_lowlevel/scripts/ros2_task.sh",
        "${input:NetworkInterface}",
        "ros2", "run", "legged_rl_deploy", "legged_rl_deploy_node",
        "${input:NetworkInterface}",
        "${env:WORKSPACE}/src/legged_rl_deploy/${input:Config Path}/config.yaml"
      ],
      "problemMatcher": []
    },
  ]
}
